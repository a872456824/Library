# 流程代码 #

```shell
#zD!/bin/bash

function C() {
    echo -e "\033[1;$1m$2\033[0m"
}

function C_HL() {
    echo -e "\033[5;1;$1m$2\033[0m"
}


a=`curl -s wttr.in/Guangzhou\?0 | head -n 7`
b=`echo "${a}" | head -n 1`

function Weather() {
    c=`echo "${a}" | head -n $1 | tail -n $2`
    echo $c
}

p=`fortune-zh | head -n 4`
p1=`echo "${p}" | head -n 1`
p2=`echo "${p}" | head -n 2 | tail -n 1`

num=`last | grep -v "^$" | grep "${USER}" | cut -d ' ' -f 1 | uniq -c | tr -s -c "0-9" | cut -d " " -f 2`

Ontime_h=`last | grep "${USER}" | head -n 2 | tail -n 1 | cut -d '(' -f 2 | cut -d ':' -f 1`
Ontime_m=`last | grep "${USER}" | head -n 2 | tail -n 1 | cut -d '(' -f 2 | cut -d ':' -f 2 | cut -d ')' -f 1`

Cutime=`date +"%Y-%m-%d %H-%M-%S"`

echo -e "
                   `C 33 " .::::."`                                       |  `C 34 "最近一段时间，亲爱的已经登陆了"` `C 32 "${num}"` `C 34 "次"`
                 `C 33 " .::::::::."`                                     |
                 `C 33 ":::::::::::"`                                     |  `C 34 "上一次登录系统，亲爱的才停留了"` `C 32 "${Ontime_h}:${Ontime_m} "`
             `C 33 "..:::::::::::'"`   `C_HL 31 "${USER},你回来了啊~"`                   |
           `C 33 "'::::::::::::''"`                                       |  `C 34 "当前登录时间为 ： "` `C 32 "${Cutime}"`
             `C 33 ".::::::::::"`                                         |
        `C 33 "'::::::::::::::.."`                                        |  `C 35 "当前的天气为 ： "`
             `C 33 "..::::::::::::."`                                     |         ${b}
             `C 33 "::::::::::::::::"`                                    |         `Weather 2 1`
            `C 33 "::::  :::::::::'        .:::."`                        |         `Weather 3 1`
           `C 33 "::::'   ':::::'       .::::::::."`                      |         `Weather 4 1`
         `C 33 ".::::'      ::::     .:::::::'::::."`                     |         `Weather 5 1`
        `C 33 ".:::'       :::::  .:::::::::' ':::::."`                   |         `Weather 6 1`
       `C 33 ".::'        :::::.:::::::::'      ':::::."`                 |         `Weather 7 1`
      `C 33 ".::'         ::::::::::::::'           ::::."`               |
  `C 33 "...:::           ::::::::::::'                ::."`              |  `C 36 "献词一首~："`
      `C 33 "':.          ':::::::::'                  ::::.."`           |         ${p1}
                    `C 33 "'.:::::'                    ':'   ''.."`       |         ${p2}
                    "
```



# 操作流程 #

### 操作思路 ###

1. 编写一个shell 脚本文件，然后在 .zshrc 文件的末尾 添加上执行流程，使得每次通过该用户登录云主机时，都会有来自  *** 女朋友 *** 的问候 

### 具体操作流程 ###

##### 1.登录次数

​      通过*** last ***提取出最近的相关登录信息，通过*** grep -v ”^$“ | greap "%{UESR}"  ***把登陆信息中空行已经不是当前用户的信息过滤掉，然后用*** cut -d ' ' -f 1 | uniq -c ***统计当前用户的登录次数，再通过 *** tr -s -c "0-9" | cut -d " " -f 2 ***将除了数字的其他信息去重并替换成空格，然后用cut切片并取出后面的数字信息，即为登录次数，用变量*** num *** 保存

```shell
num=`last | grep -v "^$" | grep "${USER}" | cut -d ' ' -f 1 | uniq -c | tr -s -c "0-9" | cut -d " " -f 2`
```

##### 2.上次登录停留了多少时间

​         上次登录时间，即为*** last ***所提供的*** loggin ***信息中，所以需要对*** last ***进行切片操作，提取出*** loggin ***信息。

​         分别通过对*** （：） ***进行切片提取，提出小时，与分钟，用变量*** Ontime_h 与 Ontime_m ***保存

```shell
Ontime_h=`last | grep "${USER}" | head -n 2 | tail -n 1 | cut -d '(' -f 2 | cut -d ':' -f 1`
Ontime_m=`last | grep "${USER}" | head -n 2 | tail -n 1 | cut -d '(' -f 2 | cut -d ':' -f 2 | cut -d ')' -f 1`
```

##### 3.推荐名言或者诗词

​          通过插件*** fortune-zh *** 随机生成古诗词，这里我将其保存在一个变量中，并提取该变量的前两行作为显示用。

```shell
p=`fortune-zh | head -n 4`
p1=`echo "${p}" | head -n 1`
p2=`echo "${p}" | head -n 2 | tail -n 1`
```

##### 4.当前时间与天气

​          通过 *** date +"%Y-%m-%d %H-%M-%S" ***得到当前时间，并将其保存在一个变量中，为后续排版做准备

```shell
Cutime=`date +"%Y-%m-%d %H-%M-%S"`
```

​         而通过*** curl -s wttr.in/Guangzhou\?0 | head -n 7 *** 获得当前的天气，将其用一个变量保存，然后写一个函数，依次获取变量中每一行的内容，为后续的排版准备。

```shell
a=`curl -s wttr.in/Guangzhou\?0 | head -n 7`
b=`echo "${a}" | head -n 1`

function Weather() {
    c=`echo "${a}" | head -n $1 | tail -n $2`
    echo $c
}
```

##### 5 颜色

​            写一个函数，使其通过输入两个参数（颜色参数，以及内容参数）就能使得要改变颜色的内容带有颜色。

```shell
#单纯的颜色函数
function C() { 
    echo -e "\033[1;$1m$2\033[0m"
}

#带闪烁的颜色函数
function C_HL() {
    echo -e "\033[5;1;$1m$2\033[0m"
}
```

##### 6.来着女朋友的问候

​          通过*** echo ***函数，将*** 女朋友 ***的样子输入，并亲切地说出带闪烁的字句，这部分也是最终的排版，需要结合上面的变量一起输出

```shell
echo -e "
                   `C 33 " .::::."`                                       |  `C 34 "最近一段时间，亲爱的已经登陆了"` `C 32 "${num}"` `C 34 "次"`
                 `C 33 " .::::::::."`                                     |
                 `C 33 ":::::::::::"`                                     |  `C 34 "上一次登录系统，亲爱的才停留了"` `C 32 "${Ontime_h}:${Ontime_m} "`
             `C 33 "..:::::::::::'"`   `C_HL 31 "${USER},你回来了啊~"`                   |
           `C 33 "'::::::::::::''"`                                       |  `C 34 "当前登录时间为 ： "` `C 32 "${Cutime}"`
             `C 33 ".::::::::::"`                                         |
        `C 33 "'::::::::::::::.."`                                        |  `C 35 "当前的天气为 ： "`
             `C 33 "..::::::::::::."`                                     |         ${b}
             `C 33 "::::::::::::::::"`                                    |         `Weather 2 1`
            `C 33 "::::  :::::::::'        .:::."`                        |         `Weather 3 1`
           `C 33 "::::'   ':::::'       .::::::::."`                      |         `Weather 4 1`
         `C 33 ".::::'      ::::     .:::::::'::::."`                     |         `Weather 5 1`
        `C 33 ".:::'       :::::  .:::::::::' ':::::."`                   |         `Weather 6 1`
       `C 33 ".::'        :::::.:::::::::'      ':::::."`                 |         `Weather 7 1`
      `C 33 ".::'         ::::::::::::::'           ::::."`               |
  `C 33 "...:::           ::::::::::::'                ::."`              |  `C 36 "献词一首~："`
      `C 33 "':.          ':::::::::'                  ::::.."`           |         ${p1}
                    `C 33 "'.:::::'                    ':'   ''.."`       |         ${p2}
                    "
```

##### 7.随用户自启动

​         将写好的*** 女朋友 ***脚本放到 *** .zshrc ***文件中，在该文件最后加上一句执行语句即可随用户启动而启动。

```shell
bash welcome.sh
```



# 女朋友展示

![LinuxTask001](https://s3.ax1x.com/2020/12/15/rKUxVx.png)